{% extends 'admin/layout_admin.html.twig' %}

{% block title %}Admin users{% endblock %}

{% block admin %}
    <h1 class="rosed font-weight-bold text-center my-2">{% trans %} Users{% endtrans %}</h1>
    <div>
        <a href="{{ path('user_new') }}" class="btn btn-info float-right my-2" data-toggle="modal" data-target="#new-user-admin">{% trans %} Create new user{% endtrans %}</a>
    </div>
    <table class="table">
        <thead class="thead-dark text-center">
            <tr>
                <th>id</th>
                <th>Name</th>
                <th>Email</th>
                <th>Enabled</th>
                <th>LastLogin</th>
                <th>Status</th>
                <th>Ville</th>
                <th>PostalCode</th>
                <th>CreatedAt</th>
                <th>Gender</th>
                <th>Birthday</th>
                <th>Point</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody class="text-center">
        {% for user in users %}
            <tr>
                <td>{{ user.id }}</td>
                <td><div class="float-left">{% if user.isAdmin() %} <i class="fas fa-user-cog rosed"></i> {% else %} <i class="fas fa-user blued"></i> {% endif %}{{ user.firstname|title }} {{ user.lastname|upper }}</div></td>
                <td>{{ user.email }}</td>
                {% if user.enabled %}
                    <td><div class="col text-center"><img src="{{ asset('/assets/images/icons/yes.png') }}" alt="yes" class="vote-avatar"></div></td>
                {% else %}
                    <td><div class="col text-center"><img src="{{ asset('/assets/images/icons/no.png') }}" alt="no" class="vote-avatar"></div></td>
                {% endif %}
                <td>{{ user.lastLogin ? user.lastLogin|date('d M-y | H:i') : '' }}</td>
                <td>
                    <div class="col text-center ">
                        {% if not user.isActiveNow() %}
                            <div class="col text-center">
                                <figure class="circle-red "></figure>
                            </div>
                        {% else %}
                            <div class="col text-center">
                                <figure class="circle-green"></figure>
                            </div>
                        {% endif %}
                    </div>
                </td>
                <td>{{ user.ville }}</td>
                <td>{{ user.postalCode }}</td>
                <td>{{ user.createdAt ? user.createdAt|date('d M -y') : '' }}</td>
                <td>{% if user.gender %}{{ user.gender|trans }}{% else %}{{ 'Unknown'|trans }}{% endif %}</td>
                <td>{{ user.birthday ? user.birthday|date('Y-m-d') : '' }}</td>
                <td>{{ user.point }}</td>
                <td>
                    <a href="{{ path('user_show', {'id': user.id}) }}"class="btn btn-info">{% trans %} show{% endtrans %}</a>
                    <form method="post" class="d-inline" action="{{ path('user_delete', {'id': user.id}) }}" onsubmit="return confirm('Are you sure you want to delete this user?');">
                        <input type="hidden" name="_method" value="DELETE">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ user.id) }}">
                        <button class="btn btn-danger">{% trans %} Delete{% endtrans %}</button>
                    </form>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="34">{% trans %} no records found{% endtrans %}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <div class="pagination-search row justify-content-center mt-4">
        <div class="navigation">
            {{ knp_pagination_render(users) }}
        </div>
    </div>


    <div class="modal fade bd-example-modal-lg mt-4" id="new-user-admin" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="z-index: 9999;">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel"></h4>
                </div>
                <div class="modal-body">
                    {{ render(controller('App\\Controller\\User\\AdminController::new')) }}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
