{% extends "layout_user.html.twig" %}

{% block title %}Hosting{% endblock %}

{% block content %}
    <h1 class="title-blue text-center">Hosting</h1>
    {% if hosting_received is not empty %}
        <div class="col-md-6 offset-3 my-2">
            {% for hosting in hosting_received %}
                <div class="border-respo px-2 py-2
                                    {% if hosting.treatment is same as('pending') %}
                                    pending
                                    {% else %}
                                    accepted
                                    {% endif %}">
                    <div class="row">
                        <div class="col-md-4">
                            <img src="{{ hosting.sender.photoProfile() }}" alt="profile photo" class="vote-avatar">
                            <span class="blue ml-1">{{ hosting.sender.firstname }}</span>
                        </div>
                        <div class="col-md-4 offset-4 ">
                            <span class="float-right py-2 px-2">{{ hosting.date|date('d M Y') }}</span>
                        </div>
                    </div>
                    <hr class="my-1">
                    <div class="row">
                        <div class="col text-center ">
                            <h6 class="blued ">Hosting request from
                                <span class="rosed">{{ hosting.startDate|date('d/m/Y') }}</span>
                                 to <span class="rosed">{{ hosting.endDate|date('d/m/Y') }}</span>
                                 for <span class="rosed">{{ hosting.numberOfPersons }}</span> persons
                            </h6>
                        </div>
                    </div>
                    <div class="row mx-2 ">
                        <div class="col-md-12">
                            <span class="blued">Description : </span>
                            <p class="minimize">{{ hosting.description }}</p>
                        </div>
                    </div>
                    <hr class="my-1">
                    <div class="row">
                        <div class="col-md-4">
                            <form method="post" action="{{ url('new_conversation') }}" id="offerUser-message">
                                <button class="btn btn-outline-info  btn-block" >
                                    <input type="hidden" name="user" value="{{ hosting.sender.id }}">
                                    <p class="mt-1">Message to {{hosting.sender.firstname}}</p>
                                </button>
                            </form>
                        </div>
                        <div class="col-md-4">
                            <form>
                                <a class="btn btn-outline-success  btn-block"
                                   href="{{ path('hosting_request_treatment', {'hostingRequest':hosting.id, 'type': 'accepted'}) }}"
                                   onclick="return confirm('Are you sure you want to accept this hosting request?');">Accept the request</a>
                            </form>
                            {#<a href="" class="btn btn-outline-success  btn-block">Accept</a>#}
                        </div>
                        <div class="col-md-4">
                            <form>
                                <a class="btn btn-outline-danger  btn-block"
                                   href="{{ path('hosting_request_treatment', {'hostingRequest':hosting.id, 'type': 'rejected'}) }}"
                                   onclick="return confirm('Are you sure you want to reject this hosting request?');">Reject the request</a>
                            </form>
                            {#<a href="" class="btn btn-outline-danger  btn-block">Reject</a>#}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

    {% else %}
        <h6 class="blued text-center">There is no hosting requests</h6>
    {% endif %}
    <script
            src="https://code.jquery.com/jquery-3.4.1.js"
            integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
            crossorigin="anonymous"></script>
    <script>
        $(function() {

            var minimized_elements = $('p.minimize');

            minimized_elements.each(function() {
                var t = $(this).text();
                if (t.length < 200) return;

                $(this).html(
                    t.slice(0, 200) + '<span>... </span><a href="#" class="more">More</a>' +
                    '<span style="display:none;">' + t.slice(100, t.length) + ' <a href="#" class="less">Less</a></span>'
                );

            });

            $('a.more', minimized_elements).click(function(event) {
                event.preventDefault();
                $(this).hide().prev().hide();
                $(this).next().show();
            });

            $('a.less', minimized_elements).click(function(event) {
                event.preventDefault();
                $(this).parent().hide().prev().show().prev().show();
            });

        });
    </script>
{% endblock %}